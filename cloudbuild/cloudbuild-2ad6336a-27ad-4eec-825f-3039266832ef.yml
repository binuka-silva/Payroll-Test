steps:
  - name: gcr.io/cloud-builders/docker
    args:
      - build
      - '--build-arg'
      - TAG_NAME=$SHORT_SHA
      - '-t'
      - gcr.io/sltution/payroll-fronend:$SHORT_SHA
      - '-f'
      - Dockerfile
      - .
  - name: gcr.io/cloud-builders/curl
    entrypoint: curl
    args:
      - '--header'
      - 'x-organization-id: e3d19597-2a4f-46a9-b3be-bfd0da5c1792'
      - '--header'
      - 'x-project-id: 8abc77d2-d0ba-4804-873c-c94236f38d4b'
      - '-d'
      - '{ "channel": "default",  "update_type": "patch", "container_id": "1426e2a3-3737-418a-9996-4fc405935b6d",  "image_name_with_tag": "gcr.io/sltution/payroll-fronend:$SHORT_SHA"}'
      - '-X'
      - POST
      - https://beta.api.platformer.com/rudder/webhook/v1/container?token=${_PLATFORMER_AUTOGENERATED_CICD}
images:
  - gcr.io/sltution/payroll-fronend:$SHORT_SHA
timeout: 1200s
